<app-navbar></app-navbar>

<div class="container" style="margin-top: 100px">
  <div class="m-3" style="display: flex; justify-content: space-between; align-items: center">
    <h3>Latest News</h3>

    <div class="d-flex align-items-center">
      <input [(ngModel)]="searchContent" type="text" class="form-control" placeholder="What happens on Sunday?" autocomplete="off">
      <button (click)="search()" class="btn btn-primary ms-2">
        <i class="fa-solid fa-magnifying-glass"></i>
      </button>
    </div>

    <div>
      <select class="form-select" id="exampleSelect1" [(ngModel)]="selectedCategoryId" (change)="filter()">
        <option [ngValue]="null" disabled selected>Filter</option>
        <option *ngFor="let category of categories" [value]="category.id">{{ category.name }}</option>
      </select>
    </div>
  </div>

  <hr class="m-3">

  <h4 *ngIf="errorMessage" class="my-5 mx-auto">Sorry, No news found!</h4>
  <h4 *ngIf="!news && !errorMessage" class="my-5 mx-auto">Loading News</h4>
  <div *ngIf="news" class="row mx-auto">

    <div *ngFor="let someNews of news" class="card border-primary mb-3 col-md-4 col-sm-6 col-12 m-3" style="max-width: 20rem;">
      <div class="card-header d-flex justify-content-between align-items-center"><span>{{ someNews.started_at }}</span>
        <div class="d-flex justify-content-between align-items-center">
          <span [routerLink]="['/news/edit', someNews.id]" class="btn btn-warning btn-sm"><i class="fa-solid fa-pencil"></i></span>
          <span (click)="confirmDelete(someNews.id)" class="btn btn-danger btn-sm ms-1"><i class="fa-solid fa-trash-can"></i></span></div>
      </div>
      <div class="card-body">
        <h4 class="card-title">{{ someNews.title }}</h4>
        <p class="card-text">{{ getPartialContent(someNews.content) }}<a (click)="toggleNewsModal(someNews.id)" style="cursor: pointer" class="text-dark"> see more</a></p>
      </div>
    </div>

  </div>

  <div class="mt-3">
    <ul class="pagination">
      <li class="page-item">
        <button [disabled]="isFirstPage()"
                (click)="onPageChange({ page: currentPage - 1})"
                class="page-link">previous</button>
      </li>
      <li *ngFor="let page of pages"
          (click)="onPageChange({ page: page})" class="page-item active">
        <button class="page-link">{{ page }}</button>
      </li>
      <li class="page-item">
        <button class="page-link" [disabled]="isLastPage()"
                (click)="onPageChange({ page: currentPage + 1})">next</button>
      </li>
    </ul>
  </div>
</div>

<div id="newsModal" #newsModal class="modal d-none mt-5">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">{{ selectedNews?.title }}</h5>
      </div>
      <div class="modal-body">
        <p>
          {{ selectedNews?.content }}
        </p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" (click)="toggleNewsModal(selectedNews?.id)">Close</button>
      </div>
    </div>
  </div>
</div>
